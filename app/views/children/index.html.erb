
<div class="wrapper wrapper-content animated fadeInRight">
  <div class="row">
    <div class="col-lg-12">

      <div class="ibox float-e-margins">

        <div class="ibox-title">
          <h5>CCV Stars children</h5>
          <div class="ibox-tools">
            <a class="btn btn-default btn-sm"
               data-toggle="collapse" data-target="#filter"><i class="fa fa-filter"></i></a>
          </div>
        </div>

        <div class="ibox-content" style="display: block;">

          <div id="filter" class="filter collapse">

            <%= form_tag children_path, method: :get, class: "filter" do |f| %>

            <div class="col-sm-6 col-sm-offset-6">
              <div class="panel panel-default">

                <div class="panel-heading">
                  <h5>Filter settings</h5>
                </div>

                <div class="panel-body">

                  <div class="col-sm-6">
                    <div class="form-group">
                      <%= label_tag :with_first_name, 'First name', :class => 'control-label' %>
                      <%= text_field_tag :with_first_name, @filter["with_first_name"], :class => 'form-control' %>
                    </div>

                    <div class="form-group">
                      <%= label_tag :with_last_name, 'Last name', :class => 'control-label' %>
                      <%= text_field_tag :with_last_name, @filter["with_last_name"], :class => 'form-control' %>
                    </div>
                  </div>

                  <div class="col-sm-6">
                    <div class="form-group">
                      <%= label_tag :with_ministry_tracker_id, 'Ministry tracker ID', :class => 'control-label' %>
                      <%= text_field_tag :with_ministry_tracker_id, @filter["with_ministry_tracker_id"], :class => 'form-control' %>
                    </div>
                  </div>

                  <div class="col-sm-12">
                    <div class="form-group pull-right">
                      <%= link_to children_clear_filter_path, :class => 'btn btn-danger' do %>
                        <i class="fa fa-times"></i> Clear filter
                      <% end %>
                      <%= button_tag(type: "submit", class: "btn btn-default") do %>
                        <i class="fa fa-filter"></i> Apply filter
                      <% end %>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <% end %>

          </div>

          <%= link_to new_child_path, :class => 'btn btn-default btn-sm' do %>
            <i class="fa fa-plus"></i> Add a child
          <% end %>
          
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Name </th>
                <th>Date of birth </th>
                <th>Age </th>
                <th>Flags </th>
                <th>Ministry Tracker ID </th>
                <th>Links </th>
              </tr>
            </thead>
            <tbody>
              <% @children.each do |child| %>
              <tr>
                <td><%= child.name %> </td>
                <td><%= date_of_birth(child) %> </td>
                <td><span class="age"><%= child.age %> </span></td>
                <td> 
                  <% if child.update_required? then %> 
                  <span class="update-details-warning fa fa-edit" 
                  data-toggle="tooltip" title="Update required"> </span> 
                  <% end %>
                  <% if child.medical_information? then %> 
                  <span class="medical-warning text-danger fa fa-medkit" 
                  data-toggle="tooltip" title="Medical information available"> </span> 
                  <% end %>
                </td>
                <td><%= child.ministry_tracker_id %> </td>
                <td>
                  <%= link_to child_path(child), :class => '' do %> 
                  <i class="fa fa-info-circle"></i> View details
                  <% end %>
                </td>
              </tr>
              <% end %>
            </tbody>
          </table>

        </div>
      </div>
    </div>
  </div>
</div>
